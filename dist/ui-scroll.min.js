/*!
 * angular-ui-scroll
 * https://github.com/angular-ui/ui-scroll.git
 * Version: 1.3.2 -- 2015-09-25T15:27:20.679Z
 * License: MIT
 */
!function(){"use strict";angular.module("ui.scroll",[]).directive("uiScrollViewport",function(){return{controller:["$scope","$element",function(a,b){return this.viewport=b,this}]}}).directive("uiScroll",["$log","$injector","$rootScope","$timeout","$q","$parse",function(a,b,c,d,e,f){var g;return b.has&&b.has("$animate")&&(g=b.get("$animate")),{require:["?^uiScrollViewport"],transclude:"element",priority:1e3,terminal:!0,compile:function(h,i,j){return function(h,i,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma;if(V=a.debug||a.log,!(W=k.uiScroll.match(/^\s*(\w+)\s+in\s+([\w\.]+)\s*$/)))throw new Error("Expected uiScroll in form of '_item_ in _datasource_' but got ' + $attr.uiScroll + '");if(S=W[1],D=W[2],C=f(D)(h),Q=function(){return angular.isObject(C)&&angular.isFunction(C.get)},!Q()&&(C=b.get(D),!Q()))throw new Error(D+" is not a valid datasource");return w=Math.max(3,+k.bufferSize||10),v=function(){return ja.outerHeight()*Math.max(.1,+k.padding||.1)},da=function(a){var b;return null!=(b=a[0].scrollHeight)?b:a[0].document.documentElement.scrollHeight},x=null,ca=0,J=1,X=1,u=[],Y=[],G=!1,s=!1,K=0,T=-1,P=1===angular.version.major&&angular.version.minor<3,aa=g?P?function(a){var b;return u.splice(u.indexOf(a),1),b=e.defer(),g.leave(a.element,function(){return a.scope.$destroy(),b.resolve()}),[b.promise]}:function(a){return u.splice(u.indexOf(a),1),[g.leave(a.element).then(function(){return a.scope.$destroy()})]}:function(a){return u.splice(u.indexOf(a),1),a.element.remove(),a.scope.$destroy(),[]},L=function(a,b){return i.after.apply(b,[a]),[]},M=g?P?function(a,b){var c;return c=e.defer(),g.enter(a,i,b,function(){return c.resolve()}),[c.promise]}:function(a,b){return[g.enter(a,i,b)]}:L,j(h.$new(),function(a,b){var c,d,e,f,g;if(b.$destroy(),e=a[0].localName,"dl"===e)throw new Error("ui-scroll directive does not support <"+a[0].localName+"> as a repeating tag: "+a[0].outerHTML);return"li"!==e&&"tr"!==e&&(e="div"),g=l[0]&&l[0].viewport?l[0].viewport:angular.element(window),g.css({"overflow-y":"auto",display:"block"}),d=function(a){var b,c,d;switch(a){case"tr":d=angular.element("<table><tr><td><div></div></td></tr></table>"),b=d.find("div"),c=d.find("tr"),c.paddingHeight=function(){return b.height.apply(b,arguments)};break;default:c=angular.element("<"+a+"></"+a+">"),c.paddingHeight=c.height}return c},f=d(e),i.before(f),c=d(e),i.after(c),h.$on("$destroy",function(){return a.remove()}),x={viewport:g,topPadding:function(){return f.paddingHeight.apply(f,arguments)},bottomPadding:function(){return c.paddingHeight.apply(c,arguments)},bottomDataPos:function(){return da(g)-c.paddingHeight()},topDataPos:function(){return f.paddingHeight()},insertElement:function(a,b){return L(a,b||f)},insertElementAnimated:function(a,b){return M(a,b||f)}}}),ja=x.viewport,ka=ja.scope()||c,ga=function(a){return n.topVisible=a.scope[S],n.topVisibleElement=a.element,n.topVisibleScope=a.scope,k.topVisible&&f(k.topVisible).assign(ka,n.topVisible),k.topVisibleElement&&f(k.topVisibleElement).assign(ka,n.topVisibleElement),k.topVisibleScope&&f(k.topVisibleScope).assign(ka,n.topVisibleScope),angular.isFunction(C.topVisible)?C.topVisible(a):void 0},U=function(a){return n.isLoading=a,k.isLoading&&f(k.isLoading).assign(h,a),angular.isFunction(C.loading)?C.loading(a):void 0},_=function(a,b){var c,d,e,f;for(c=d=e=a,f=b;f>=e?f>d:d>f;c=f>=e?++d:--d)u[c].scope.$destroy(),u[c].element.remove();return u.splice(a,b-a)},E=function(){return ca++,Y=[]},$=function(){return E(),J=1,X=1,_(0,u.length),x.topPadding(0),x.bottomPadding(0),G=!1,s=!1,p(ca)},m=function(){return ja[0].getBoundingClientRect().bottom},t=function(){return ja.scrollTop()+ja.outerHeight()},ha=function(){return ja.scrollTop()},ea=function(){return!G&&x.bottomDataPos()<t()+v()},A=function(){var a,b,c,d,e,f,g,h,i,j;for(a=0,h=0,b=f=i=u.length-1;0>=i?0>=f:f>=0;b=0>=i?++f:--f)if(c=u[b],e=c.element.offset().top,g=j!==e,j=e,g&&(d=c.element.outerHeight(!0)),x.bottomDataPos()-a-d>t()+v())g&&(a+=d),h++,G=!1;else{if(g)break;h++}return h>0?(x.bottomPadding(x.bottomPadding()+a),_(u.length-h,u.length),X-=h):void 0},fa=function(){return!s&&x.topDataPos()>ha()-v()},B=function(){var a,b,c,d,e,f,g,h,i;for(i=0,g=0,d=0,e=u.length;e>d;d++)if(a=u[d],c=a.element.offset().top,f=h!==c,h=c,f&&(b=a.element.outerHeight(!0)),x.topDataPos()+i+b<ha()-v())f&&(i+=b),g++,s=!1;else{if(f)break;g++}return g>0?(x.topPadding(x.topPadding()+i),_(0,g),J+=g):void 0},F=function(a,b){return n.isLoading||U(!0),1===Y.push(b)?I(a):void 0},N=function(a,b){var c,d;if(c=h.$new(),c[S]=b,d={scope:c},j(c,function(a){return d.element=a}),a%1===0)return d.op="insert",u.splice(a,0,d);switch(d.op=a,a){case"append":return u.push(d);case"prepend":return u.unshift(d)}},R=function(a){return a.element.height()&&a.element[0].offsetParent},la=function(a){var b,c,d;if(R(a)){for(c=0,d=u.length;d>c;c++)b=u[c],angular.isFunction(b.unregisterVisibilityWatcher)&&(b.unregisterVisibilityWatcher(),delete b.unregisterVisibilityWatcher);return p()}},O=function(a,b){return x.insertElement(a.element,b),R(a)?!0:(a.unregisterVisibilityWatcher=a.scope.$watch(function(){return la(a)}),!1)},Z=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,q,r,s,t;for(q=[],r=[],s=[],b=x.bottomDataPos(),d=g=0,k=u.length;k>g;d=++g)switch(t=u[d],t.op){case"prepend":r.unshift(t);break;case"append":i=0===d?O(t)||i:O(t,u[d-1].element)||i,t.op="none";break;case"insert":q=0===d?q.concat(x.insertElementAnimated(t.element)):q.concat(x.insertElementAnimated(t.element,u[d-1].element)),t.op="none";break;case"remove":s.push(t)}for(h=0,l=s.length;l>h;h++)t=s[h],q=q.concat(aa(t));if(x.bottomPadding(Math.max(0,x.bottomPadding()-(x.bottomDataPos()-b))),r.length){for(b=x.bottomDataPos(),j=0,m=r.length;m>j;j++)t=r[j],i=O(t)||i,t.op="none";c=x.bottomDataPos()-b,x.topPadding()>=c?x.topPadding(x.topPadding()-c):ja.scrollTop(ja.scrollTop()+c)}for(d=o=0,n=u.length;n>o;d=++o)f=u[d],f.scope.$index=J+d;return q.length&&e.all(q).then(function(){return p(a)}),i},z=function(){var a,b,c,d,e,f,g,h,i,j;for(j=0,h=[],a=e=0,f=u.length;f>e;a=++e)if(b=u[a],d=b.element.offset().top,g=i!==d,i=d,g&&(c=b.element.outerHeight(!0)),g&&x.topDataPos()+j+c<ha())h.push(j+=c);else{if(g){K=a,ga(b);break}h.push(void 0)}return h},y=function(){var a;for(a=u.length;a--;)if(u[a].element[0].getBoundingClientRect().top<m()){T=a;break}},p=function(a){return d(function(){Z(a),ea()?F(a,!0):fa()&&F(a,!1),0===Y.length&&(z(),y())})},q=function(a){return d(function(){var b;return b=Z(a),ea()?b&&F(a,!0):fa()&&(b||Y[0])&&F(a,!1),Y.shift(),0!==Y.length?I(a):(U(!1),z(),y(),void 0)})},I=function(a){return Y[0]?u.length&&!ea()?q(a):C.get(X,w,function(b){var c,d,e;if(!(a&&a!==ca||h.$$destroyed)){if(b.length<w&&(G=!0,x.bottomPadding(0)),b.length>0)for(B(),d=0,e=b.length;e>d;d++)c=b[d],++X,N("append",c);return q(a)}}):u.length&&!fa()?q(a):C.get(J-w,w,function(b){var c,d,e;if(!(a&&a!==ca||h.$$destroyed)){if(b.length<w&&(s=!0,x.topPadding(0)),b.length>0)for(u.length&&A(),c=d=e=b.length-1;0>=e?0>=d:d>=0;c=0>=e?++d:--d)--J,N("prepend",b[c]);return q(a)}})},ba=function(){return c.$$phase||n.isLoading?void 0:(p(),h.$apply())},ma=function(a){var b,c;return b=ja[0].scrollTop,c=ja[0].scrollHeight-ja[0].clientHeight,0===b&&!s||b===c&&!G?a.preventDefault():void 0},ja.bind("resize",ba),ja.bind("scroll",ba),ja.bind("mousewheel",ma),h.$watch(C.revision,$),h.$on("$destroy",function(){var a,b,c;for(b=0,c=u.length;c>b;b++)a=u[b],a.scope.$destroy(),a.element.remove();return ja.unbind("resize",ba),ja.unbind("scroll",ba),ja.unbind("mousewheel",ma)}),n={},n.isLoading=!1,n.reload=$,r=function(a,b){var c,d,e,f,g,h,i;if(angular.isArray(b)){for(h=u.indexOf(a)+1,i=b.reverse(),c=d=0,f=i.length;f>d;c=++d)g=i[c],g===a.scope[S]?(e=!0,h--):N(h,g);if(!e)return a.op="remove"}},n.applyUpdates=function(a,b){var c,d,e,f,g,h;if(E(),angular.isFunction(a))for(c=u.slice(0),d=e=0,f=c.length;f>e;d=++e)h=c[d],r(h,a(h.scope[S],h.scope,h.element));else{if(a%1!==0)throw new Error("applyUpdates - "+a+" is not a valid index");0<=(g=a-J)&&g<u.length&&r(u[a-J],b)}return p(ca)},n.append=function(a){var b,c,d;for(E(),c=0,d=a.length;d>c;c++)b=a[c],++X,N("append",b);return p(ca)},n.prepend=function(a){var b,c,d,e;for(E(),e=a.reverse(),c=0,d=e.length;d>c;c++)b=e[c],--J,N("prepend",b);return p(ca)},n.visibleItems=function(a){var b,c,d;for(c=[],b=K,d=Math.min(T,u.length-1);d>=b;)c.push(u[b].scope[S][a]),b++;return c},k.adapter&&(o=f(k.adapter)(h),o||(f(k.adapter).assign(h,{}),o=f(k.adapter)(h)),angular.extend(o,n),n=o),ia=function(a){throw new Error(a+" event is no longer supported - use applyUpdates instead")},H=C.scope?C.scope.$new():h.$new(),H.$on("insert.item",function(){return ia("insert")}),H.$on("update.items",function(){return ia("update")}),H.$on("delete.items",function(){return ia("delete")})}}}}])}();